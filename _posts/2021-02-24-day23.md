---
title:  "Day23 학습정리"
excerpt: "AI Math"

categories:
  - Blog
tags:
  - [Blog, jekyll, Github, Git]
use_math: true
toc: true
toc_sticky: true
 
date: 2021-02-24
last_modified_at: 2021-02-24
---

## 그래프의 구조를 어떻게 분석할까?

1. 군집 구조와 군집 탐색 문제

2. 군집 구조의 통계적 유의성과 군집성

3. 군집 탐색 알고리즘

4. 중첩이 있는 군집 탐색

5. (실습) Girvan-Newman 알고리즘 구현 및 적용

---

### 군집 구조와 군집 탐색 문제

* 군집의 정의

    * 군집(Community)이란 다음 조건들을 만족하는 정점들의 집합이다. <br/>
    <br/>
    (1) 집합에 속하는 정점 사이에는 많은 간선이 존재<br/>
    (2) 집합에 속하는 정점과 그렇지 않은 정점 사이에는 적은 수의 간선이 존재

* 실제 그래프에서의 군집

    * 온라인 소셜 네트워크 군집들은 사회적 무리를 의미하는 경우가 많다.

    * 뉴런간 연결 그래프에서는 군집들이 뇌의 기능적 구성 단위를 의미

* 군집 탐색 문제

    * 그래프를 여러 군집으로 잘 나누는 문제를 ***군집 탐색 문제*** 라고 한다.

    * 보통은 각 정점이 한 개의 군집에 속하도록 군집을 나눈다. 비지도 기계학습 문제인 클러스터링과 유사

---

## 군집 구조의 통계적 유의성과 군집성

* 비교 대상 : 배치 모형

    * 성공적인 군집 탐색을 정의하기 위해 먼저 배치 모형(Configuration Model)을 정의 

    * 주어진 그래프에 대한 배치 모형은 각 정점의 연결성(Degree)을 보존하고 간선들을 무작위로 재배치하여 얻은 그래프이다. 

    ![image-ConfigurationModel](../../assets/img/boostcamp/ConfigurationModel.png)

    * 배치 모형에서 임의의 두 정점 $i$와 $j$ 사이에 간선이 존재할 확률은 두 정점의 연결성에 비례한다.

* 군집성의 정의

    * 군집 탐색의 성공 여부를 판단하기 위해, 군집성(Modularity)가 사용된다.

    * 그래프와 군집들의 집합 $S$가 주어졌을 때, 각 군집 $s \in S$가 군집의 성질을 잘 만족하는 지를 보기위해 군집 내부의 간선의 수를 그래프와 배치 모형에서 비교한다.

    * 군집성은 다음 수식으로 계산 된다.

    ![image-Modularity](../../assets/img/boostcamp/Modularity.png)

    * 즉, 배치모형과 비교 했을 때, 그래프에서 군집 내부 간서의 수가 월등이 많을 수록 성공한 군집 탐색이다.

    * 군집성은 -1과 1사이의 값을 가지며, 보통 0.3~0.7 정도의 값을 가질 때, 통계적으로 유의미한 군집들을 찾아냈다고 한다.

---

## 군집 탐색 알고리즘

* Girvan-Newman 알고리즘

    * Girvan-Newman 알고리즘은 대표적인 하향식(Top-Down) 군집 탐색 알고리즘이다.

    * Girvan-Newman 알고리즘은 전체 그래프에서 탐색을 시작해 군집들이 서로 분리되도록, 간선을 순차적으로 제거한다.

    * 서로 다른 군집을 연결하는 다리 역할의 간선을 제거하여 군집을 분류해낸다.

        * 서로 다른 군집을 연결하는 다리 역할의 간선을 찾아내기 위해 ***매개 중심성(Betweenness Centrality)*** 을 사용한다. 이는 해당 간선이 정점 간의 최단 경로에 놓이는 횟수를 의미한다.

        ![image-BetweennessCentrality](../../assets/img/boostcamp/BetweennessCentrality.png)

    * Girvan-Newman 알고리즘은 매개 중심성이 높은 간선을 순차적으로 제거한다.

    * 간선은 군집성이 최대가 되는 지점까지 제거한다. 단, 현재의 연결 요소들을 군집으로 가정하되, 입력 그래프에서 군집성을 계산한다.

    * 정리 

        1. 전체 그래프에서 시작

        2. 매개 중심성이 높은 순서대로 간선을 제거하고 군집성의 변화를 기록.

        3. 군집성이 가장 커지는 상황을 복원

        4. 이 때, 서로 연결된 정점들, 즉 연결 요소를 하나의 군집으로 간주

        * 전체 그래프에서 시작해 작은 단위를 검색하는 하향식(Top-Down)방법

* Louvain 알고리즘

    * Louvain 알고리즘은 대표적인 상향식(Bottom-Up) 군집 탐색 알고리즘이다.

    * Louvain 알고리즘은 개별 정점에서 시작해 점점 큰 군집을 형성한다.

    1. Louvain 알고리즘은 개별 정점으로 구성된 크기 1의 군집들로부터 시작

    2. 각 정점 $u$를 기존 혹은 새로운 군집으로 이동한다. 이 때, 군집성이 최대화되도록 군집을 결정

    3. 더 이상 군집성이 증가하지 않을 때까지 2)를 반복

    4. 각 군집을 하나의 정점으로하는 군집 레벨의 그래프를 얻은 뒤 3)을 수행

    5. 한 개의 정점이 남을 때까지 4)를 반복

---

## 중첩이 있는 군집 탐색

* 실제 그래프의 군집들은 중첩되어 있는 경우가 많다.

* 중접이 있는 군집을 찾아내기 위해서는 다음과 같은 방법을 이용한다.

    1. 각 정점은 여러 개의 군집에 속할 수 있다고 가정.

    2. 각 군집 $A$에 대하여, 같은 군집에 속하는 두 정점은 $P_{A}$확률로 간선으로 직접 연결된다.

    3. 두 정점이 여러 군집에 동시에 속할 경우 간선 연결 확률은 독립적이다. 예를 들어, 두 정점이 군집 $A$와 $B$에 동시에 속할 경우 두 정점이 간선으로 직접 연결될 확률은 1-(1-$P_A$)(1-$P_B$)이다.

    4. 어느 군집에도 함께 속하지 않은 두 정점은 낮은 확률 $\epsilon$으로 연결


* [Girvan-Newman알고리즘 실습](https://github.com/kyungminkim-dev/boostcamp-ai-tech/blob/main/Lab05_Girvan_Newman_Algorithm_%26_Real_World_Graph_Community_Detection%EC%9D%98_%EC%82%AC%EB%B3%B8.ipynb){: target="_blank"}

---

# 그래프를 추천시스템에 어떻게 활용할까?

1. 내용기반 추천 시스템

2. 협업 필터링 

3. 추천 시스템의 평가

4. 실습 : 협업 필터링 구현

---

## 내용기반 추천 시스템(Contents based)

* 내용 기반(Content-based) 추천은 각 사용자가 구매/만족했던 상품과 유사한 것을 추천하는 방법

    * 동일한 장르의 영화 추천, 동일한 감독의 영화, 동일 배우의 영화, 동일한 카테고리의 상품 추천등

* 내용 기반의 추천은 네 단계로 이루어 진다.

    1. 사용자가 선호했던 상품들의 상품 프로필을 수집하는 단계. ***상품 프로필*** 은 해당 상품의 특성을 나열한 벡터이다. 영화의 경우 감독, 장르, 배우 등의 원-핫 인코딩이 상품 프로필이 될 수 있다.

    2. ***사용자 프로필*** 을 구성하는 단계. 사용자 프로필은 선호한 상품의 상품 프로필을 선호도를 사용하여 가중 평균하여 계산. 

    3. 사용자 프로필 벡터 $\vec{u}$와 상품 프로필 벡터 $\vec{v}$의 코사인 유사도를 계산. 유사도가 높을 수록, 해당 사용자가 과거 선호했던 상품들과 해당 상품이 유사함을 의미

    4. 계산한 코사인 유사도가 높은 상품을 추천

* 내용 기반 추천시스템의 장점

    * 다른 사용자의 구매 기록이 필요하지 않다.

    * 독특한 취향의 사용자에게도 추천이 가능

    * 새 상품에 대해서도 추천이 가능

    * 추천의 이유를 제공할 수 있다.

* 내용 기반 추천시스템의 단점

    * 상품에 대한 부가 정보가 없는 경우에는 사용할 수 없다.

    * 구매 기록이 없는 사용자에게 사용할 수 없다.

    * 과적합으로 지나치게 협소한 추천을 할 수 있다.

--- 

## 협업 필터링 추천시스템(Collaborative filtering)

* 사용자-사용자 협업 필터링은 다음 세 단계로 이루어진다.

    1. 추천의 대사 사용자 $x$와 유사한 취향의 사용자들을 찾는다.

    2. 유사한 취향의 사용자들이 선호한 상품을 찾는다.

    3. 2단계에서 찾은 상품을 $x$에게 추천한다.

* 취향의 유사성은 상관 계수(Correlation Coefficient)를 통해 측정한다.

![image-CorrelationCoefficient](../../assets/img/boostcamp/CorrelationCoefficient.png)


* 취향의 유사도를 가중치로 사용한 평점의 가중 평균을 통해 평점을 추정한다.

![image-WeightedMean](../../assets/img/boostcamp/WeightedMean.png)

* 협업 필터링의 장점

    * 상품에 대한 부가 정보가 없는 경우에도 사용 가능

* 협업 필터링의 단점

    * 충분한 수의 평점 데이터가 누적되어야 효과적이다.

    * 새 상품, 새로운 사용자에 대한 추천이 불가.

    * 독특한 취향의 사용자에게 추천이 어렵다.

---

## 추천 시스템의 평가

* 과정

    1. 데이터를 훈련데이터와 평가 데이터로 분리

    2. 평가 데이터가 주어지지 않았다고 가정

    ![image-DataTable](../../assets/img/boostcamp/DataTable.png)

    3. 훈련 데이터를 이용해 평가 데이터의 평점을 추정 

    4. 추정한 평점과 실제 평가 데이처를 비교하여 오차를 측정. MSE 나 RMSE가 많이 사용됨

---

## 협업 필터링 구현

* [협업필터링 실습](https://github.com/kyungminkim-dev/boostcamp-ai-tech/blob/main/Week5(Graph)/day22/%EC%8B%A4%EC%8A%B53_ipynb.ipynb){: target="_blank"}











