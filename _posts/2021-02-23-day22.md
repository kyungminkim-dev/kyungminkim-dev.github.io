---
title:  "Day22 학습정리"
excerpt: "AI Math"

categories:
  - Blog
tags:
  - [Blog, jekyll, Github, Git]
use_math: true
toc: true
toc_sticky: true
 
date: 2021-02-23
last_modified_at: 2021-02-23
---

1. 페이지랭크의 배경

2. 페이지랭크의 정의

3. 페이지랭크의 계산

4. (실습) 페이지랭크 

---

## 페이지랭크의 배경

* 웹과 그래프 

    * 웹은 웹페이지와 하이퍼링크로 구성된 거대한 방향성이 있는 그래프이다.

        * 웹페이지는 정점, 웹페이지가 포함하는 링크는 나가는 간선에 해당한다. 웹페이지는 추가적으로 키워드 정보를 포함한다.

    * 시용자 키워드와 관련성과 신뢰성이 높은 웹페이지를 찾고자 페이지랭크의 개념이 생겨났다.

---

## 페이지랭크의 정의

* 페이지랭크의 핵심은 투표이다. 투표를 통해 사용자 키워드와 관련성이 높고 신뢰할 수 있는 웹페이지를 탐색한다. 투표의 주체는 웹페이지이고 하이퍼링크를 통해 투표를 한다.

* 만약 웹페이지 $u$가 $v$로의 하이퍼링크를 포함한다면 $u$가 $v$에게 투표를 한 것이라고 생각할 수 있다.

* 즉, 들어오는 간선이 많을 수록 신뢰할 수 있다는 뜻이다. 

* 하지만 들어오는 간선의 수 만으로는 판단하기 힘들다. 임의로 간선의 수를 부풀릴 수 있기 때문. 

* 따라서 관련성이 높고 신뢰할 수 있는 웹사이트의 투표를 더 중요하게 하는 가중 투표를 한다.

* 측정하려는 웹페이지의 관련성 및 신뢰도를 ***페이지랭크 점수***라고 한다.

* $r_{j}=\sum_{i\in N_{in}(j)} {r_{i} \over d_{out}(i)}$

* 임의 보행을 통해 웹 서핑을 하는 웹서퍼가 현재 페이지에 존재하는 하이퍼 링크 중 하나를 무작위로 클릭하여 웹을 서핑한다. <br/>

    웹서퍼가 $t$번째 방문한 웹페이지가 웹페이지 $i$일 확률을 $p_{i}(t)$라 하자.<br/>
    그러면 $p(t)$는 길이가 웹페이지 수와 같은 확률분포 벡터가 된다.<br/>
    웹서퍼가 이 과정을 무한히 반복하면 확률분포 $p(t)$는 수렴한다. 따라서 투표관점 페이지랭크 점수는 임의 보행 관점에서의 정상 분포와 같다.


---

## 페이지랭크의 계산

* 페이지랭크 점수의 계산은 반복곱을 사용한다.

* 반복곱은 항상 수렴하는 것은 아니다.

    * 들어오는 간선은 있지만 나가는 간선은 없는 정점 집합인 스파이더 트랩(Spider Trap)에의한 문제, 막다른 정점(Dead End)문제가 있다.

* 문제 해결을 위해 순간이동(Teleport)를 사용

    1. 현재 웹페이지에 하이퍼링크가 없다면, 임의의 페이지로 순간이동을 한다.

    2. 현재 웹페이지에 하이퍼링크가 있다면, 앞면이 나올 확률인 $\alpha$인 동전을 던진다.

    3. 앞면이라면, 하이퍼링크 중 하나를 균일한 확률로 선택해 이동.

    4. 뒷면이라면, 임의의 웹페이지로 순간이동


* (1),(4)의 임의의 웹페이지는 전체 웹페이지중 하나를 균일 확률로 선책한다. $\alpha$를 감폭비율(Damping Factor)라고 부르며 보통 0.8을 사용

![image-PageRank](../../assets/img/boostcamp/PageRank.png)


* [페이지랭크 실습](https://github.com/kyungminkim-dev/boostcamp-ai-tech/blob/main/Week5(Graph)/day22/%EC%8B%A4%EC%8A%B53_ipynb.ipynb){: target="_blank"}

---
---

1. 그래프를 통한 전파의 예시

2. 의사결정 기반의 전파 모형

3. 확률적 전파 모형

4. 바이럴 마케팅과 전파 최대화 문제

5. (실습) 전파 모형 시뮬레이터 구현

---

## 그래프를 통한 전파 예시

* 그래프를 통한 정보의 전파

    * 온라인 소셜 네트워크를 통해 다양한 정보가 전파된다.

* 그래프를 통한 행동의 전파

    * ex) 아이스 버킷 챌린지, 펭귄문제

* 그래프를 통한 고장의 전파

    * 컴퓨터 네트워크에서의 일부 장비의 고장이 전파되어 전체 네트워크를 마비시킬 수 있다.

* 그래프를 통한 질병의 전파

    * 사회라는 거대한 소셜 네트워크를 통한 질병의 전파

* 전파 괴정은 다양한고 매우 복잡하다. 이를 체계적으로 이해하고 대처하기 위해 수학적 모형화가 필요하다.(두 가지를 소개)

---

## 의사결정 기반의 전파 모형

* 주변 사람들의  의사결정을 고려하여 각자 의사결정을 내리는 경우에 ***의사결정 기반의 전파 모형***을 사용한다.

* 가장 간단한 형태의 의사결정 기반의 전파 모형인 ***선형 임계치 모형(Linear Threshold Model)***


![image-LTM](../../assets/img/boostcamp/LTM.png)

* 위의 모형을 선형 임계치 모형(Linear threshold Model)이라고 한다.

* 각 정점은 이웃 중 A를 선택한 비율이 임계치 $q$를 넘을 때만 A를 선택한다.


---

## 확률적 전파 모형

* 코로나의 전파 과정을 수학적으로 추상화보자.

    * 의사결정 기반 모형을 적합하지 않다. 코로나에 걸리기로 의사결정을 내리는 사람은 없기 때문.

    * 코로나의 전파는 확률적 과정이기 때문에 확률적 전파 모형을 고려

* 독립 전파 모형(Independent Cascade Model)

    * 방향성이 있고 가중치가 있는 그래프를 가정.

    * 각 간선 ($u$,$v$)의 가중치 $P_{uv}$는 $u$가 감여되었을 때($v$가 감염되지 않았을 때) $u$가 $v$v를 감염시킬 확률이다. 

    * 서로 다른 이웃이 전염되는 확률은 독립적이다.

    * 각 최초 감염자를 Seet Set이라고 하고 더 이상 새로운 감염자가 없으면 종료한다.<br/>

    감염자는 계속 감염자 상태로 남아있는 것을 가정. 감염자의 회복을 가정하는 SIS, SIR등의 다른 전파도 있다.

---

## 바이럴 마케팅과 전파 최대화 문제

* 바이럴 마케팅은 소비자들로 하여금 상품에 대한 긍정적인 입소문을 내게 하는 기법이다.

* 그래프, 전파 모형, 그리고 시드 집합의 크기가 주어졌을 때 전파를 최대화 하는 시드 집합을 찾는 문제를 ***전파최대화(Influence Maximization)*** 문제라 한다.

* 전파 최대화문제는 매우 어려우므로 최고의 시드 집합을 찾는 것은 무리이다.

* 정점 중심성 휴리스틱

    * 시드 집합의 크기가 $k$개로 고정되어 있을 때, 정점의 중심성이 높은 순으로 $k$개 정점을 선택하는 방법.

    * 정점의 중심성으로는 페이지랭크 점수, 연결 중심성, 근접 중심성, 매개 중심성 등이 있다.

    * 합리적이지만 최고의 시드 집합을 찾는다는 보장은 없다.

* 탐욕 알고리즘

    * 탐욕 알고리즘은 시드 집합의 원소, 즉 최초 전파자를 한번에 한 명씩 선택

    * 정점의 집합에서 전파를 최대화 하는 원소를 하나씩 선택하여 시드 집합의 원소를 고른다. 전파의 크기를 비교하기 위해 시뮬레이션을 반복하여 평균을 구하여 비교한다.

    * 목표하는 크기의 시드 집합에 도달할 때까지 반복.

    * 즉, 탐욕 알고리즘은 최초 전파자 간의 조합의 효과는 배제하고 근시안적으로 최초 전파자를 선택하는 과정을 반복한다.

 
---
## 전파 모형 시뮬레이터 구현

* [페이지랭크 실습](https://github.com/kyungminkim-dev/boostcamp-ai-tech/blob/main/Week5(Graph)/day22/%EC%8B%A4%EC%8A%B54_ipynb.ipynb){: target="_blank"}
